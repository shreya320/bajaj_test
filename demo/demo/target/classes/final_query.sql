SELECT 
  d.DEPARTMENT_NAME AS DEPARTMENT_NAME,
  ROUND(AVG(DATEDIFF(YEAR, e.DOB, GETDATE())), 2) AS AVERAGE_AGE,
  STRING_AGG(CONCAT(e.FIRST_NAME, ' ', e.LAST_NAME), ', ') 
      WITHIN GROUP (ORDER BY e.EMP_ID) AS EMPLOYEE_LIST
FROM DEPARTMENT d
JOIN EMPLOYEE e ON e.DEPARTMENT = d.DEPARTMENT_ID
JOIN PAYMENTS p ON p.EMP_ID = e.EMP_ID
WHERE p.AMOUNT > 70000
GROUP BY d.DEPARTMENT_ID, d.DEPARTMENT_NAME
ORDER BY d.DEPARTMENT_ID DESC
OFFSET 0 ROWS FETCH NEXT 10 ROWS ONLY;
